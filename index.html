<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CS Tools</title>
  <link rel="stylesheet" href="style.css" />
</head>
<body>

  <!-- ðŸ”¹ ç§»åŠ¨ç«¯èœå•æŒ‰é’® -->
  <div class="menu-toggle" onclick="toggleMenu()">â˜° Menu</div>

  <!-- ðŸ”¹ ä¾§è¾¹æ  -->
  <div class="sidebar">
    <h2>CS Tools</h2>
    <ul>
      <li><a href="pages/WIreCut.html" target="contentFrame" class="active">Wire EDM Calculator</a></li>
      <li><a href="pages/CSQR.html" target="contentFrame">QR & Barcode Generator</a></li>
      <li><a href="pages/MillingCalculator.html" target="contentFrame">Milling Calculator</a></li>

      <!-- ðŸ”¹ Turning Calculator ä¸»èœå• -->
      <li class="submenu">
        <a href="#" onclick="toggleSubmenu(event)">Turning Calculator â–¸</a>
        <ul class="submenu-items">
          <li><a href="pages/Turning/Diagonal.html" target="contentFrame">Calculate Diagonal</a></li>
          <li><a href="pages/Turning/AngleFormula.html" target="contentFrame">Formula for Finding Angle</a></li>
          <li><a href="pages/Turning/DistanceFormula.html" target="contentFrame">Formula for Distance Calculation</a></li>
        </ul>
      </li>
    </ul>

    <footer>
      <p>Â© 2025 CircleSpin</p>
    </footer>
  </div>

  <!-- ðŸ”¹ ä¸»å†…å®¹ -->
  <div class="main-content">
    <div id="loading">Loading...</div>
    <iframe name="contentFrame" src="pages/WIreCut.html" id="mainFrame"></iframe>
  </div>

  <!-- ðŸ”¹ è„šæœ¬ -->
  <script>
    // èœå•é€‰ä¸­çŠ¶æ€åˆ‡æ¢
    const links = document.querySelectorAll('.sidebar a[target="contentFrame"]');
    links.forEach(link => {
      link.addEventListener('click', () => {
        links.forEach(l => l.classList.remove('active'));
        link.classList.add('active');
      });
    });

    // iframe åŠ è½½åŠ¨ç”»
    const iframe = document.getElementById('mainFrame');
    const loading = document.getElementById('loading');
    iframe.addEventListener('load', () => {
      loading.style.display = 'none';
    });
    iframe.addEventListener('loadstart', () => {
      loading.style.display = 'flex';
    });

    // ðŸ”¹ ç§»åŠ¨ç«¯èœå•å¼€å…³
    function toggleMenu() {
      const sidebar = document.querySelector('.sidebar');
      sidebar.classList.toggle('show');
    }

    // ðŸ”¹ å±•å¼€/æ”¶èµ·å­èœå•
    function toggleSubmenu(event) {
      event.preventDefault();
      const parent = event.target.closest('.submenu');
      parent.classList.toggle('open');

      // æ”¹å˜ç®­å¤´æ–¹å‘
      const arrow = parent.querySelector('a');
      if (parent.classList.contains('open')) {
        arrow.innerHTML = "Turning Calculator â–¾";
      } else {
        arrow.innerHTML = "Turning Calculator â–¸";
      }
    }
    
          // âœ… ç‚¹å‡»èœå•é¡¹åŽè‡ªåŠ¨å…³é—­èœå•ï¼ˆé€‚ç”¨äºŽæ‰‹æœºï¼‰
      document.querySelectorAll('.sidebar a[target="contentFrame"]').forEach(link => {
        link.addEventListener('click', () => {
          const sidebar = document.querySelector('.sidebar');
          sidebar.classList.remove('show'); // è‡ªåŠ¨å…³é—­èœå•

          // âœ… ä¿å­˜å½“å‰ iframe é¡µé¢çš„åœ°å€åˆ° localStorage
          localStorage.setItem('lastPage', link.getAttribute('href'));
        });
      });

      // âœ… ç›‘å¬é¡µé¢åŠ è½½æ—¶ï¼Œæ¢å¤ä¸Šæ¬¡æµè§ˆçš„é¡µé¢
      window.addEventListener('load', () => {
        const lastPage = localStorage.getItem('lastPage');
        const iframe = document.getElementById('mainFrame');

        if (lastPage) {
          iframe.src = lastPage;

          // è®©å¯¹åº”èœå•é¡¹é«˜äº®
          document.querySelectorAll('.sidebar a[target="contentFrame"]').forEach(link => {
            link.classList.toggle('active', link.getAttribute('href') === lastPage);
          });
        }
      });

      // âœ… å½“ç‚¹å‡»â€œTurning Calculatorâ€å­èœå•é‡Œçš„é¡¹ç›®æ—¶ï¼Œä¹Ÿä¼šè‡ªåŠ¨å…³é—­èœå•
      document.querySelectorAll('.submenu-items a').forEach(link => {
        link.addEventListener('click', () => {
          const sidebar = document.querySelector('.sidebar');
          sidebar.classList.remove('show');
        });
      });

  </script>
</body>
</html>
